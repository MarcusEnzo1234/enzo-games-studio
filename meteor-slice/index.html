<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1, user-scalable=no"/>
  <title>Neon Breaker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    html,body{height:100%;margin:0}
    body{overflow:hidden;background:#070914;font-family:"Press Start 2P",system-ui;user-select:none;touch-action:manipulation}
    canvas{position:fixed;inset:0;width:100vw;height:100vh;display:block}
    .ui{position:fixed;inset:0;pointer-events:none;display:flex;justify-content:center;align-items:flex-start;padding:14px;color:#eaf2ff;text-shadow:2px 2px 0 rgba(0,0,0,.45)}
    .row{width:min(980px,96vw);display:flex;justify-content:space-between;gap:10px;align-items:center;flex-wrap:wrap}
    .pill{padding:10px 12px;border:3px solid rgba(255,255,255,.18);background:rgba(255,255,255,.10);border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.35);font-size:12px}
    .screen{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:auto;background:rgba(0,0,0,.18);backdrop-filter:blur(2px)}
    .panel{width:min(860px,92vw);border:4px solid rgba(255,255,255,.22);background:rgba(10,14,30,.86);border-radius:18px;box-shadow:0 24px 80px rgba(0,0,0,.60);padding:18px;color:#eaf2ff;text-align:center}
    .title{font-size:22px;margin:6px 0 12px}
    .sub{font-size:12px;opacity:.85;line-height:1.6;margin:0 0 16px}
    .btnRow{display:flex;justify-content:center;gap:10px;flex-wrap:wrap}
    button{font-family:"Press Start 2P";font-size:12px;padding:12px 14px;border-radius:14px;border:4px solid rgba(255,255,255,.22);background:#7df9ff;color:#081021;cursor:pointer;box-shadow:0 10px 0 rgba(0,0,0,.35)}
    button.alt{background:#ffe680} button.danger{background:#ff5a78}
    button:active{transform:translateY(6px);box-shadow:0 4px 0 rgba(0,0,0,.35)}
    .hide{display:none}
  </style>
</head>
<body>
<canvas id="c"></canvas>

<div class="ui">
  <div class="row">
    <div class="pill">SCORE: <span id="score">0</span></div>
    <div class="pill">LIVES: <span id="lives">3</span></div>
    <div class="pill">BEST: <span id="best">0</span></div>
    <div class="pill">MOVE: MOUSE/TAP â€¢ SPACE LAUNCH</div>
  </div>
</div>

<div id="menu" class="screen">
  <div class="panel">
    <div class="title">ðŸ§± NEON BREAKER</div>
    <div class="sub">Break neon bricks. Catch powerups. Donâ€™t drop the ball.</div>
    <div class="btnRow">
      <button id="start">START</button>
      <button id="credits" class="alt">CREDITS</button>
    </div>
  </div>
</div>

<div id="creditScreen" class="screen hide">
  <div class="panel">
    <div class="title">CREDITS</div>
    <div class="sub">GameMaker: <b>Enzo</b></div>
    <div class="btnRow"><button id="back" class="alt">BACK</button></div>
  </div>
</div>

<div id="over" class="screen hide">
  <div class="panel">
    <div class="title">GAME OVER</div>
    <div class="sub">Tap / Space to retry</div>
    <div class="btnRow">
      <button id="retry" class="danger">RETRY</button>
      <button id="menuBtn" class="alt">MENU</button>
    </div>
  </div>
</div>

<script>
const c=document.getElementById("c"),ctx=c.getContext("2d");
const scoreEl=document.getElementById("score"), livesEl=document.getElementById("lives"), bestEl=document.getElementById("best");
const menu=document.getElementById("menu"), over=document.getElementById("over"), creditScreen=document.getElementById("creditScreen");

function resize(){
  const dpr=Math.max(1,Math.min(2,devicePixelRatio||1));
  c.width=Math.floor(innerWidth*dpr); c.height=Math.floor(innerHeight*dpr);
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
addEventListener("resize",resize); resize();

const AudioCtx=window.AudioContext||window.webkitAudioContext; const audio=new AudioCtx();
function beep(f=880,d=0.06,type="square",v=0.05){
  try{const o=audio.createOscillator(),g=audio.createGain();
  o.type=type;o.frequency.value=f;g.gain.value=v;o.connect(g).connect(audio.destination);
  o.start();g.gain.exponentialRampToValueAtTime(0.001,audio.currentTime+d);
  o.stop(audio.currentTime+d+0.01);}catch{}
}
const sfx={hit:()=>beep(980,0.05,"square",0.05),power:()=>beep(520,0.08,"square",0.05),lose:()=>beep(160,0.12,"sawtooth",0.06)};

let best=+localStorage.getItem("neonBreakerBest")||0; bestEl.textContent=best;
let state="menu", t=0, score=0, lives=3;

const paddle={x:0,y:0,w:140,h:18};
const ball={x:0,y:0,r:8,vx:0,vy:0,stuck:true};
const bricks=[];
const parts=[];
const powerups=[]; // {x,y,vy,type}

function hideAll(){ menu.classList.add("hide"); over.classList.add("hide"); creditScreen.classList.add("hide"); }
function showMenu(){ hideAll(); state="menu"; menu.classList.remove("hide"); }
function showCredits(){ hideAll(); state="credits"; creditScreen.classList.remove("hide"); }
function showOver(){
  hideAll(); state="over"; over.classList.remove("hide");
  if(score>best){ best=score; localStorage.setItem("neonBreakerBest",String(best)); bestEl.textContent=best; }
}
document.getElementById("start").onclick=()=>start();
document.getElementById("retry").onclick=()=>start();
document.getElementById("menuBtn").onclick=()=>showMenu();
document.getElementById("credits").onclick=()=>showCredits();
document.getElementById("back").onclick=()=>showMenu();

function rand(a,b){ return a+Math.random()*(b-a); }

function start(){
  hideAll(); state="play";
  t=0; score=0; lives=3;
  scoreEl.textContent=score; livesEl.textContent=lives;
  parts.length=0; powerups.length=0;

  paddle.y=innerHeight*0.86;
  paddle.x=innerWidth/2;

  ball.stuck=true;
  ball.x=paddle.x; ball.y=paddle.y-28;
  ball.vx=0; ball.vy=0;

  buildBricks();
}

function buildBricks(){
  bricks.length=0;
  const cols=10, rows=6;
  const pad=10;
  const top=110;
  const areaW=Math.min(innerWidth*0.9, 980);
  const left=(innerWidth-areaW)/2;
  const bw=(areaW - pad*(cols-1))/cols;
  const bh=28;

  const colors=["#7df9ff","#ff5a78","#c084fc","#a3e635","#ffe680"];
  for(let r=0;r<rows;r++){
    for(let col=0;col<cols;col++){
      const x=left + col*(bw+pad);
      const y=top + r*(bh+pad);
      const hp= r<2 ? 2 : 1; // top rows harder
      bricks.push({x,y,w:bw,h:bh,hp,col:colors[(r+col)%colors.length]});
    }
  }
}

function addParts(x,y,col,n=12){
  for(let i=0;i<n;i++){
    parts.push({x,y,vx:rand(-2.2,2.2),vy:rand(-2.4,2.0),life:18+Math.random()*12,col});
  }
}

function rectHit(ax,ay,aw,ah,bx,by,bw,bh){ return ax<bx+bw && ax+aw>bx && ay<by+bh && ay+ah>by; }

function launch(){
  if(state!=="play") return;
  if(!ball.stuck) return;
  ball.stuck=false;
  const angle = rand(-0.9, -2.2); // upward-ish
  ball.vx = Math.cos(angle)*6.4;
  ball.vy = Math.sin(angle)*6.4;
  beep(740,0.06,"square",0.05);
}

function update(){
  t++;

  // particles
  for(let i=parts.length-1;i>=0;i--){
    const p=parts[i];
    p.x+=p.vx; p.y+=p.vy; p.vy+=0.10;
    p.vx*=0.94; p.vy*=0.94; p.life--;
    if(p.life<=0) parts.splice(i,1);
  }

  if(state!=="play") return;

  // keep ball with paddle
  if(ball.stuck){
    ball.x = paddle.x;
    ball.y = paddle.y - 28;
  } else {
    ball.x += ball.vx;
    ball.y += ball.vy;
  }

  // walls
  if(ball.x - ball.r < 0){ ball.x=ball.r; ball.vx*=-1; }
  if(ball.x + ball.r > innerWidth){ ball.x=innerWidth-ball.r; ball.vx*=-1; }
  if(ball.y - ball.r < 0){ ball.y=ball.r; ball.vy*=-1; }

  // drop
  if(ball.y - ball.r > innerHeight){
    lives--;
    livesEl.textContent=lives;
    sfx.lose();
    ball.stuck=true;
    if(lives<=0){ showOver(); return; }
  }

  // paddle collision
  const px=paddle.x-paddle.w/2, py=paddle.y-paddle.h/2;
  if(!ball.stuck && rectHit(ball.x-ball.r, ball.y-ball.r, ball.r*2, ball.r*2, px, py, paddle.w, paddle.h)){
    ball.y = py - ball.r;
    // angle based on hit position
    const hit = (ball.x - paddle.x) / (paddle.w/2);
    ball.vx = hit * 7.0;
    ball.vy = -Math.abs(ball.vy);
    sfx.hit();
  }

  // bricks collision
  for(let i=bricks.length-1;i>=0;i--){
    const b=bricks[i];
    if(rectHit(ball.x-ball.r, ball.y-ball.r, ball.r*2, ball.r*2, b.x, b.y, b.w, b.h)){
      // bounce simple
      ball.vy *= -1;
      b.hp--;
      addParts(ball.x, ball.y, b.col, 10);
      sfx.hit();

      if(b.hp<=0){
        // chance powerup
        if(Math.random()<0.18){
          const type = Math.random()<0.5 ? "big" : "multi";
          powerups.push({x:b.x+b.w/2, y:b.y+b.h/2, vy:3.2, type});
        }
        bricks.splice(i,1);
        score += 5;
        scoreEl.textContent=score;
        if(bricks.length===0){
          // next level: rebuild harder
          buildBricks();
          ball.stuck=true;
        }
      }
      break;
    }
  }

  // powerups fall
  for(let i=powerups.length-1;i>=0;i--){
    const p=powerups[i];
    p.y += p.vy;
    if(p.y>innerHeight+40){ powerups.splice(i,1); continue; }

    if(rectHit(p.x-10,p.y-10,20,20, px, py, paddle.w, paddle.h)){
      sfx.power();
      if(p.type==="big"){
        paddle.w = Math.min(paddle.w + 40, 220);
      } else if(p.type==="multi"){
        // spawn a second ball by "faking" multi: add score bonus + speed
        score += 20; scoreEl.textContent=score;
        ball.vx *= 1.12; ball.vy *= 1.12;
      }
      powerups.splice(i,1);
    }
  }

  // slowly shrink paddle back
  paddle.w = Math.max(130, paddle.w - 0.02);
}

function drawBG(){
  const w=innerWidth,h=innerHeight;
  const g=ctx.createLinearGradient(0,0,0,h);
  g.addColorStop(0,"#0b1030"); g.addColorStop(1,"#070914");
  ctx.fillStyle=g; ctx.fillRect(0,0,w,h);

  ctx.save(); ctx.globalAlpha=0.18;
  ctx.fillStyle="#7df9ff"; ctx.beginPath(); ctx.arc(w*0.2,h*0.2,180,0,Math.PI*2); ctx.fill();
  ctx.fillStyle="#c084fc"; ctx.beginPath(); ctx.arc(w*0.82,h*0.25,240,0,Math.PI*2); ctx.fill();
  ctx.restore();
}

function drawPaddle(){
  ctx.save();
  ctx.translate(paddle.x,paddle.y);
  ctx.shadowColor="rgba(125,249,255,0.9)"; ctx.shadowBlur=18;
  ctx.fillStyle="rgba(255,255,255,0.10)";
  ctx.strokeStyle="#7df9ff"; ctx.lineWidth=3;
  ctx.beginPath();
  ctx.roundRect(-paddle.w/2, -paddle.h/2, paddle.w, paddle.h, 10);
  ctx.fill(); ctx.stroke();
  ctx.restore();
}

function drawBall(){
  ctx.save();
  ctx.translate(ball.x, ball.y);
  ctx.shadowColor="rgba(255,230,128,0.9)"; ctx.shadowBlur=16;
  ctx.fillStyle="#ffe680";
  ctx.beginPath(); ctx.arc(0,0,ball.r,0,Math.PI*2); ctx.fill();
  ctx.restore();
}

function drawBricks(){
  for(const b of bricks){
    ctx.save();
    ctx.shadowColor=b.col; ctx.shadowBlur=18;
    ctx.fillStyle="rgba(255,255,255,0.08)";
    ctx.strokeStyle=b.col; ctx.lineWidth=3;
    ctx.fillRect(b.x,b.y,b.w,b.h);
    ctx.strokeRect(b.x,b.y,b.w,b.h);

    if(b.hp>1){
      ctx.shadowBlur=0;
      ctx.globalAlpha=0.25;
      ctx.fillStyle="#fff";
      ctx.fillRect(b.x+6,b.y+6,b.w-12,b.h-12);
    }
    ctx.restore();
  }
}

function drawPowerups(){
  for(const p of powerups){
    ctx.save();
    ctx.translate(p.x,p.y);
    ctx.shadowBlur=18;
    ctx.shadowColor = p.type==="big" ? "#a3e635" : "#c084fc";
    ctx.fillStyle="rgba(255,255,255,0.10)";
    ctx.strokeStyle = p.type==="big" ? "#a3e635" : "#c084fc";
    ctx.lineWidth=3;
    ctx.beginPath(); ctx.arc(0,0,12,0,Math.PI*2); ctx.fill(); ctx.stroke();

    ctx.shadowBlur=0;
    ctx.fillStyle="#fff";
    ctx.globalAlpha=0.6;
    ctx.font="10px 'Press Start 2P', system-ui";
    ctx.textAlign="center"; ctx.textBaseline="middle";
    ctx.fillText(p.type==="big" ? "B" : "M", 0, 1);
    ctx.restore();
  }
}

function drawParts(){
  for(const p of parts){
    ctx.save();
    ctx.globalAlpha=Math.max(0,p.life/28);
    ctx.fillStyle="rgba(255,255,255,0.9)";
    ctx.fillRect(p.x,p.y,2,2);
    ctx.restore();
  }
}

function render(){
  ctx.clearRect(0,0,c.width,c.height);
  drawBG();
  drawBricks();
  drawPowerups();
  drawParts();
  drawPaddle();
  drawBall();

  if(state==="play" && ball.stuck){
    ctx.save();
    ctx.fillStyle="rgba(255,255,255,0.75)";
    ctx.font="14px 'Press Start 2P', system-ui";
    ctx.fillText("PRESS SPACE TO LAUNCH", 24, 86);
    ctx.restore();
  }
}

function pointerMove(clientX){
  const rect=c.getBoundingClientRect();
  const mx=(clientX-rect.left)*(c.width/rect.width);
  paddle.x = mx;
  paddle.x = Math.max(paddle.w/2+10, Math.min(innerWidth-paddle.w/2-10, paddle.x));
}
c.addEventListener("pointermove",(e)=>pointerMove(e.clientX));
c.addEventListener("pointerdown",(e)=>{
  if(state==="menu"||state==="over"){ start(); return; }
  pointerMove(e.clientX);
  launch();
});
addEventListener("keydown",(e)=>{
  if(e.code==="Space"){
    if(state==="menu"||state==="over") start();
    else launch();
  }
});

if(!CanvasRenderingContext2D.prototype.roundRect){
  CanvasRenderingContext2D.prototype.roundRect=function(x,y,w,h,r){
    r=Math.min(r,w/2,h/2);
    this.beginPath();
    this.moveTo(x+r,y);
    this.arcTo(x+w,y,x+w,y+h,r);
    this.arcTo(x+w,y+h,x,y+h,r);
    this.arcTo(x,y+h,x,y,r);
    this.arcTo(x,y,x+w,y,r);
    this.closePath();
    return this;
  }
}

function loop(){ update(); render(); requestAnimationFrame(loop); }
showMenu(); loop();
</script>
</body>
</html>
